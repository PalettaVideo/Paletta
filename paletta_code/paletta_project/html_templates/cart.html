{% load static %}
{% if user.is_authenticated %}
<!DOCTYPE html>
<html lang="en">
<head>
  <title>Paletta - Shopping Cart</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Styles -->
  <link rel="icon" type="image/x-icon" href="{% static 'picture/logo.ico' %}">
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
  <!-- CSS Reusables -->
  <link rel="stylesheet" href="{% static 'css/header_reusable.css' %}">
  <link rel="stylesheet" href="{% static 'css/footer_reusable.css' %}">
  <!-- CSS -->
  <link rel="stylesheet" href="{% static 'css/cart.css' %}">
  <!-- JS -->
  <script src="{% static 'js/cart.js' %}" defer></script>
</head>
<body>
  {% include "html_reusables/header_reusable.html" %}
  
  <div class="layout">
    <!-- Sidebar -->
    <aside class="sidebar">
      <nav>
        <ul>
          <li><a href="{% url 'profile' %}">My profile</a></li>
          <li><a href="{% url 'collection' %}">My collection</a></li>
          <li><a href="{% url 'cart' %}" class="active">My cart</a></li>
          <li><a href="{% url 'order' %}">My order</a></li>
        </ul>
      </nav>
    </aside>

    <!-- Main content -->
    <main class="content">
      <h1>My Cart (<span id="cart-count">0</span>)</h1>
      
      <div class="cart-container">
        <div class="cart-items" id="cart-items">
          {% if cart_items %}
            {% for item in cart_items %}
            <div class="cart-item" data-id="{{ item.id }}">
              {% if item.thumbnail %}
                <img src="{{ item.thumbnail }}" alt="{{ item.title }}">
              {% else %}
                <img src="{% static 'picture/default_thumbnail.png' %}" alt="{{ item.title }}">
              {% endif %}
              
              <div class="cart-item-details">
                <h3>{{ item.title }}</h3>
                <p>Resolution: {{ item.resolution }}</p>
                <p class="cart-item-price">£{{ item.price }}</p>
              </div>
              
              <div class="cart-item-actions">
                <button class="remove" data-id="{{ item.id }}">Remove</button>
              </div>
            </div>
            {% endfor %}
          {% else %}
            <div class="empty-cart">
              <p>Your cart is empty. <a href="{% url 'library_detail' library_slug='paletta' %}">Browse clip store</a> to add items.</p>
              <a href="{% url 'library_detail' library_slug='paletta' %}">
                <button>Browse Clip Store</button>
              </a>
            </div>
          {% endif %}
        </div>
        
        <div class="cart-summary">
          <h3>Order Summary</h3>
          <p>Subtotal: <span id="subtotal">£0.00</span></p>
          <p>VAT (20%): <span id="vat">£0.00</span></p>
          <p class="total">Total: <span id="cart-total">£0.00</span></p>
          <button id="checkout-button" {% if not cart_items %}disabled{% endif %}>Proceed to Checkout</button>
        </div>
      </div>
    </main>
  </div>

  {% csrf_token %}
  {% include "html_reusables/footer_reusable.html" %}
</body>
</html>

{% else %}
{% include "html_reusables/unauthorised_reusable.html" %}
{% endif %}