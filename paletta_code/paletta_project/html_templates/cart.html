<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  {% load static %}
  <link href="{% static 'css/cart.css' %}" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
  <script src="{% static 'js/navigation_scripts.js' %}" defer></script>
  <script src="{% static 'js/cart.js' %}" defer></script>
  <link href="{% static 'css/header_component.css' %}" rel="stylesheet">
  <link href="{% static 'css/footer_component.css' %}" rel="stylesheet">
  <title>Shopping Cart</title>
  <link rel="icon" type="image/x-icon" href="{% static 'picture/logo.ico' %}">
</head>
<body>
  {% include "html_components/header_component.html" %}
  
  {% if user.is_authenticated %}
  <div class="layout">
    <!-- Sidebar -->
    <aside class="sidebar">
      <nav>
        <ul>
          <li><a href="{% url 'profile' %}">My profile</a></li>
          <li><a href="{% url 'collection' %}">My collection</a></li>
          <li><a href="{% url 'cart' %}" class="active">My cart</a></li>
          <li><a href="{% url 'order' %}">My order</a></li>
        </ul>
      </nav>
    </aside>

    <!-- Main content -->
    <main class="content">
      <h1>My Cart (<span id="cart-count">0</span>)</h1>
      
      <div class="cart-container">
        <div class="cart-items" id="cart-items">
          {% if cart_items %}
            {% for item in cart_items %}
            <div class="cart-item" data-id="{{ item.id }}">
              {% if item.thumbnail %}
                <img src="{{ item.thumbnail }}" alt="{{ item.title }}">
              {% else %}
                <img src="{% static 'picture/default_thumbnail.png' %}" alt="{{ item.title }}">
              {% endif %}
              
              <div class="cart-item-details">
                <h3>{{ item.title }}</h3>
                <p>Resolution: {{ item.resolution }}</p>
                <p class="cart-item-price">£{{ item.price }}</p>
              </div>
              
              <div class="cart-item-actions">
                <button class="remove" data-id="{{ item.id }}">Remove</button>
              </div>
            </div>
            {% endfor %}
          {% else %}
            <div class="empty-cart">
              <p>Your cart is empty. <a href="{% url 'clip_store' %}">Browse clip store</a> to add items.</p>
              <a href="{% url 'clip_store' %}">
                <button>Browse Clip Store</button>
              </a>
            </div>
          {% endif %}
        </div>
        
        <div class="cart-summary">
          <h3>Order Summary</h3>
          <p>Subtotal: <span id="subtotal">£0.00</span></p>
          <p>VAT (20%): <span id="vat">£0.00</span></p>
          <p class="total">Total: <span id="cart-total">£0.00</span></p>
          <button id="checkout-button" {% if not cart_items %}disabled{% endif %}>Proceed to Checkout</button>
        </div>
      </div>
    </main>
  </div>
  {% else %}
  <div class="unauthorized-message">
    <h2>Please log in to view your cart</h2>
    <p>You need to be logged in to view and manage your cart.</p>
    <div class="action-buttons">
      <a href="{% url 'login' %}">
        <button>Log In</button>
      </a>
      <a href="{% url 'register' %}">
        <button>Register</button>
      </a>
    </div>
  </div>
  {% endif %}
  
  {% csrf_token %}
  {% include "html_components/footer_component.html" %}
</body>
</html>
