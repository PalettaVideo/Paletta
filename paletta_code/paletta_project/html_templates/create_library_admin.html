{% load static %}
{% if user.is_authenticated %}
<!DOCTYPE html>
<html lang="en">
<head>
    <title>{% if current_library %}{{ current_library.name }}{% else %}Paletta{% endif %} - Create a Library</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Styles -->
    <link rel="icon" type="image/x-icon" href="{% static 'picture/logo.ico' %}">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
    <!-- CSS Reusables -->
    <link rel="stylesheet" href="{% static 'css/header_reusable.css' %}">
    <link rel="stylesheet" href="{% static 'css/footer_reusable.css' %}">
    <link rel="stylesheet" href="{% static 'css/button_reusable.css' %}">
    <link rel="stylesheet" href="{% static 'css/layout.css' %}">
    <!-- CSS -->
    <link rel="stylesheet" href="{% static 'css/create_library_admin.css' %}">
    <!-- JS -->
    <script src="{% static 'js/create_library_admin.js' %}" defer></script>
</head>

<body>
    {% include "html_reusables/header_reusable.html" %}

    <div class="layout">
        <aside class="sidebar">
            <ul>
                <li><a href="{% url 'create_library' %}" class="active">Create a Library</a></li>
                <li><a href="{% url 'manage_libraries' %}">Manage All Libraries</a></li>
                <li><a href="{% url 'manage_administrators' %}">Manage Administrators</a></li>
            </ul>
        </aside>

        <main class="content">
            <h2>Create a Library</h2>
            
            <form method="post" enctype="multipart/form-data" id="library-form">
                {% csrf_token %}
                {% if form.non_field_errors %}
                    <div class="error-message">
                        {{ form.non_field_errors }}
                    </div>
                {% endif %}
                
                <label for="id_name">Name</label>
                <input type="text" id="id_name" name="name" maxlength="100" placeholder="Enter name" required>
                {% if form.name.errors %}
                    <div class="error-message">{{ form.name.errors }}</div>
                {% endif %}

                <label for="id_logo">Logo</label>
                <div id="upload-box" style="border: 2px dashed #ccc; padding: 10px; cursor: pointer;">
                    select a Logo
                    <input type="file" id="file-input" name="logo" accept="image/*" style="display: none;">
                </div>
                
                <div id="preview-container"></div>
                {% if form.logo.errors %}
                    <div class="error-message">{{ form.logo.errors }}</div>
                {% endif %}

                <label for="id_description">Description</label>
                <textarea id="id_description" name="description" maxlength="100" placeholder="Enter description" required></textarea>
                {% if form.description.errors %}
                    <div class="error-message">{{ form.description.errors }}</div>
                {% endif %}
                
                <label for="id_storage_tier">Storage Tier</label>
                <select id="id_storage_tier" name="storage_tier">
                    <option value="basic">Basic (up to 100GB)</option>
                    <option value="pro">Professional (up to 1TB)</option>
                    <option value="enterprise">Enterprise (up to 10TB)</option>
                </select>
                {% if form.storage_tier.errors %}
                    <div class="error-message">{{ form.storage_tier.errors }}</div>
                {% endif %}

                <!-- Category Source Selection -->
                <div class="category-source-container">
                    <label class="category-source-label">Category Management</label>
                    <p class="category-explanation">Choose how video categories will be managed in this library:</p>
                    
                    <div class="category-source-options">
                        <div class="category-option">
                            <input type="radio" id="paletta_style" name="category_source" value="paletta_style" checked>
                            <label for="paletta_style">
                                <strong>Use Paletta Style Categories</strong>
                                <p class="option-description">
                                    Uses predefined Paletta categories (People & Community, Buildings & Architecture, etc.) 
                                    combined with flexible content types (Campus Life, Teaching & Learning, etc.). 
                                    Perfect for educational institutions.
                                </p>
                            </label>
                        </div>
                        
                        <div class="category-option">
                            <input type="radio" id="custom" name="category_source" value="custom">
                            <label for="custom">
                                <strong>Create My Own Categories</strong>
                                <p class="option-description">
                                    Uses academic subject areas (Engineering Sciences, Medical Sciences, etc.) 
                                    combined with content types. Ideal for specialized academic or research institutions 
                                    that need subject-specific organization.
                                </p>
                            </label>
                        </div>
                    </div>
                    
                    <div id="category-preview" class="category-preview">
                        <h4>Category Structure Preview:</h4>
                        <div id="preview-content">
                            <div class="preview-section">
                                <strong>Paletta Categories:</strong> People & Community, Buildings & Architecture, Classrooms & Learning Spaces, etc.
                            </div>
                            <div class="preview-section">
                                <strong>Content Types:</strong> Campus Life, Teaching & Learning, Research & Innovation, etc. (1-3 per video)
                            </div>
                            <div class="preview-section">
                                <strong>Tags:</strong> Optional custom tags for additional organization
                            </div>
                        </div>
                    </div>
                </div>

                {% if form.category_source.errors %}
                    <div class="error-message">{{ form.category_source.errors }}</div>
                {% endif %}

                <label for="id_theme_color">Theme Colour</label>
                <div id="colorPickerContainer">
                    <div id="colorPreview" onclick="toggleColorPicker()"></div>
                    <input type="color" id="themeColor" name="primary_color" onchange="updateColor()" value="#86B049">
                </div>
                {% if form.theme_color.errors %}
                    <div class="error-message">{{ form.theme_color.errors }}</div>
                {% endif %}

                <button type="submit" class="create-btn">Create Library</button>
            </form>
        </main>
    </div>

    {% include "html_reusables/footer_reusable.html" %}

</body>
</html>

{% else %}
{% include "html_reusables/unauthorised_reusable.html" %}
{% endif %}
