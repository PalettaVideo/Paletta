<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{% if current_category %}{{ current_category.name }}{% else %}All Videos{% endif %} - Paletta</title>
  {% load static %}
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
  <link href="{% static 'css/navigation_internal.css' %}" rel="stylesheet">
  <link href="{% static 'css/inside_category.css' %}" rel="stylesheet">
  <script src="{% static 'js/inside_category.js' %}" defer></script>
  <script src="{% static 'js/navigation_scripts.js' %}" defer></script>
  <link rel="icon" type="image/x-icon" href="{% static 'picture/logo.ico' %}">
</head>
<body>
<header>
  <div class="logo-container">
    <a href="{% url 'home' %}" style="text-decoration: none;">
      <div class="logo">
        <img src="{% static 'picture/logo.jpg' %}" alt="Logo">
      </div>
    </a>
    <div class="search-bar">
      <input type="text" id="header-search" placeholder="Search in the whole store">
      <button id="header-search-btn">
        <svg id="Icons" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" width="20" height="20">
          <path class="cls-1" d="M18.856,14.624a10.022,10.022,0,1,0-4.234,4.234l4.254,4.255a2.994,2.994,0,1,0,4.239-4.23ZM2,10a8,8,0,1,1,8,8A8.009,8.009,0,0,1,2,10ZM21.7,21.708a1,1,0,0,1-1.4,0l-3.967-3.968a10.092,10.092,0,0,0,1.4-1.406L21.705,20.3a.976.976,0,0,1-.009,1.407Z" />
          <path class="cls-1" d="M10,4a6.006,6.006,0,0,0-6,6,1,1,0,0,0,2,0,4,4,0,0,1,4-4,1,1,0,0,0,0-2Z" />
        </svg>
      </button>
    </div>

    <div class="actions">
      {% if user.is_authenticated and user.role != 'customer' %}
      <a href="{% url 'upload' %}" style="text-decoration: none;">
        <button>
          <svg style="enable-background:new 0 0 24 24;" version="1.1" viewBox="0 0 24 24" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
            <g id="grid_system"/>
            <g id="_icons">
              <g>
                <path d="M8.7,9.7L11,7.4V15c0,0.6,0.4,1,1,1s1-0.4,1-1V7.4l2.3,2.3C15.5,9.9,15.7,10,16,10s0.5-0.1,0.7-0.3c0.4-0.4,0.4-1,0-1.4l-4-4c-0.1-0.1-0.2-0.2-0.3-0.2c-0.2-0.1-0.5-0.1-0.8,0c-0.1,0.1-0.2,0.1-0.3,0.2l-4,4c-0.4,0.4-0.4,1,0,1.4S8.3,10.1,8.7,9.7z"/>
                <path d="M19,13c-0.6,0-1,0.4-1,1v2c0,1.1-0.9,2-2,2H8c-1.1,0-2-0.9-2-2v-2c0-0.6-0.4-1-1-1s-1,0.4-1,1v2c0,2.2,1.8,4,4,4h8c2.2,0,4-1.8,4-4v-2C20,13.4,19.6,13,19,13z"/>
              </g>
            </g>
          </svg>
          Upload
        </button>
      </a>
      {% endif %}
      <button id="centerButton">
        <svg viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg" width="24" height="24">
          <g data-name="Layer 2" id="Layer_2">
            <path d="M16,29A13,13,0,1,1,29,16,13,13,0,0,1,16,29ZM16,5A11,11,0,1,0,27,16,11,11,0,0,0,16,5Z" />
            <path d="M16,17a5,5,0,1,1,5-5A5,5,0,0,1,16,17Zm0-8a3,3,0,1,0,3,3A3,3,0,0,0,16,9Z" />
            <path d="M25.55,24a1,1,0,0,1-.74-.32A11.35,11.35,0,0,0,16.46,20h-.92a11.27,11.27,0,0,0-7.85,3.16,1,1,0,0,1-1.38-1.44A13.24,13.24,0,0,1,15.54,18h.92a13.39,13.39,0,0,1,9.82,4.32A1,1,0,0,1,25.55,24Z" />
          </g>
        </svg>
        My Center
      </button>
      <div class="popup" id="popupMenu">
        <a href="{% url 'profile' %}">My Profile</a>
        <a href="{% url 'collection' %}">My Collection</a>
        <a href="{% url 'cart' %}">My Cart</a>
        <a href="{% url 'order' %}">My Order</a>
        <a href="{% url 'logout' %}">Log Out</a>
      </div>
    </div>
  </div>
</header>
<main>
  <aside class="sidebar">
    <div class="backbutton">
      <a href="{% url 'home' %}"> 
        <svg baseProfile="tiny" height="24px" id="Layer_1" version="1.2" viewBox="0 0 24 24" width="24px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g>
          <path d="M19.164,19.547c-1.641-2.5-3.669-3.285-6.164-3.484v1.437c0,0.534-0.208,1.036-0.586,1.414   c-0.756,0.756-2.077,0.751-2.823,0.005l-6.293-6.207C3.107,12.523,3,12.268,3,11.999s0.107-0.524,0.298-0.712l6.288-6.203   c0.754-0.755,2.073-0.756,2.829,0.001C12.792,5.463,13,5.965,13,6.499v1.704c4.619,0.933,8,4.997,8,9.796v1   c0,0.442-0.29,0.832-0.714,0.958c-0.095,0.027-0.19,0.042-0.286,0.042C19.669,19.999,19.354,19.834,19.164,19.547z M12.023,14.011   c2.207,0.056,4.638,0.394,6.758,2.121c-0.768-3.216-3.477-5.702-6.893-6.08C11.384,9.996,11,10,11,10V6.503l-5.576,5.496l5.576,5.5   V14C11,14,11.738,14.01,12.023,14.011z"/></g></svg>
        <span>Back</span>
      </a>
    </div>
    <ul class="category-list">
      <li class="{% if category_filter == 'all' %}active{% endif %}" data-category="all">All Clips</li>
      {% for category in categories %}
      <li class="{% if category_filter == category.name|lower %}active{% endif %}" data-category="{{ category.name|lower }}">
        {{ category.name }}
      </li>
      {% endfor %}
    </ul>
  </aside>
  
  <section class="main-content">
    <div class="banner">
      {% if current_category %}
        <div class="imagecontainer">
          <h1 class="banner-title">{{ current_category.name }}</h1>
          <!-- Simple image priority flow -->
          {% if category_banner_url %}
            <img src="{{ category_banner_url }}" alt="{{ current_category.name }}" class="category-image">
          {% elif category_image_url %}
            <img src="{{ category_image_url }}" alt="{{ current_category.name }}" class="category-image">
          {% else %}
            <!-- Default image when no images are available -->
            <img src="{% static 'picture/All.png' %}" alt="{{ current_category.name }}" class="category-image">
          {% endif %}
        </div>
      {% elif category_not_found %}
        <div class="imagecontainer">
          <h1 class="banner-title">Category Not Found</h1>
          <p>The category "{{ attempted_category_name }}" could not be found.</p>
          <img src="{% static 'picture/All.png' %}" alt="Category Not Found" class="category-image">
        </div>
      {% else %}
        <!-- All clips view -->
        <img src="{% static 'picture/All.png' %}" alt="All">
        <h1 class="banner-title">All Videos in the Library</h1>
      {% endif %}
    </div>
    
    <div class="category-actions">
      <div class="categorysearch">
        <input type="text" id="category-search-input" placeholder="Search in this category">
        <button id="search-category-button">
          <svg id="Icons" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" width="20" height="20">
            <path class="cls-1" d="M18.856,14.624a10.022,10.022,0,1,0-4.234,4.234l4.254,4.255a2.994,2.994,0,1,0,4.239-4.23ZM2,10a8,8,0,1,1,8,8A8.009,8.009,0,0,1,2,10ZM21.7,21.708a1,1,0,0,1-1.4,0l-3.967-3.968a10.092,10.092,0,0,0,1.4-1.406L21.705,20.3a.976.976,0,0,1-.009,1.407Z" />
            <path class="cls-1" d="M10,4a6.006,6.006,0,0,0-6,6,1,1,0,0,0,2,0,4,4,0,0,1,4-4,1,1,0,0,0,0-2Z" />
          </svg>
        </button>
      </div>
      <div class="filters">
        <button id="tagsFilterButton" style="position: relative;">Tags Filter (<span id="tagsCount">0</span>)</button>
        <div class="popup" id="tagsFilterPopup">
          <div class="popup-header">
            <h3>Filter by Tags</h3>
          </div>
          <div class="popup-body">
            <div class="tags-list">
              {% for tag in popular_tags %}
              <div class="tag-item">
                <input type="checkbox" id="tag{{ tag.id }}" value="{{ tag.name }}">
                <label for="tag{{ tag.id }}">{{ tag.name }}</label>
              </div>
              {% endfor %}
            </div>
          </div>
          <div class="popup-footer">
            <button id="applyTagsFilter" class="apply-button">Apply</button>
          </div>
        </div>
        <button id="sortByButton" style="position: relative;">Sort by â–¼</button>
        <div class="popup" id="sortByPopup">
          <a href="#" data-sort="newest">Newest</a>
          <a href="#" data-sort="oldest">Oldest</a>
          <a href="#" data-sort="popular">Most Popular</a>
          <a href="#" data-sort="price-asc">Price: Low to High</a>
          <a href="#" data-sort="price-desc">Price: High to Low</a>
        </div>
      </div>
    </div>
    
    <div class="clips-container" id="clips-container">
      <div class="loading-indicator">
        <div class="spinner"></div>
        <p>Loading clips...</p>
      </div>
    </div>
    
    <div class="pagination-controls" id="pagination-controls">
      <!-- Pagination will be added dynamically by JavaScript -->
    </div>
  </section>
</main>

<!-- Video Preview Modal -->
<div id="videoPreviewModal" class="modal">
  <div class="modal-content">
    <span class="close-modal">&times;</span>
    <div class="video-preview-container">
      <div class="video-player">
        <video id="preview-video" controls>
          <source src="" type="video/mp4">
          Your browser does not support the video tag.
        </video>
      </div>
      <div class="video-details">
        <h2 id="modal-video-title">Video Title</h2>
        <div class="video-meta">
          <span class="meta-item">
            <i class="fa fa-clock-o"></i>
            <span id="modal-video-duration">00:00</span>
          </span>
          <span class="meta-item">
            <i class="fa fa-user"></i>
            <span id="modal-video-uploader">Username</span>
          </span>
          <span class="meta-item">
            <i class="fa fa-calendar"></i>
            <span id="modal-video-date">Date</span>
          </span>
        </div>
        <div class="video-description">
          <p id="modal-video-description">Loading video description...</p>
        </div>
        <div class="video-tags" id="modal-video-tags">
          <!-- Tags will be added dynamically -->
        </div>
        <div class="video-actions">
          <button class="add-to-cart-btn" id="add-to-cart-modal">Add to Cart</button>
          <button class="add-to-favorites-btn" id="add-to-favorites-modal">Add to Collection</button>
        </div>
      </div>
    </div>
  </div>
</div>

<footer class="footer">
  <div class="divider"></div>
  <div class="footer-content">
    <!-- Logo Section -->
    <div class="footer-logo">
      <img src="{% static 'picture/logo.jpg' %}" alt="PALETTA Logo" style="width: 100px;">
      <p>&copy; FILMBRIGHT LTD. 2024</p>
    </div>

    <!-- Company Section -->
    <div class="footer-column">
      <h4>Company</h4>
      <ul>
        <li><a href="{% url 'about_us' %}">About us</a></li>
        <li><a href="{% url 'contact_us' %}">Contact us</a></li>
      </ul>
    </div>

    <!-- Support Section -->
    <div class="footer-column">
      <h4>Support</h4>
      <ul>
        <li><a href="{% url 'q_and_a' %}">Help & Support</a></li>
        <li><a href="#">Terms & Conditions</a></li>
        <li><a href="#">Privacy</a></li>
      </ul>
    </div>

    <!-- Social Media Section -->
    <div class="footer-column">
      <h4>Find us</h4>
      <div class="social-icon" >
        <a href="https://www.instagram.com/filmbright/" >
            <svg data-name="Layer 1" id="Layer_1" viewBox="0 0 128 128" xmlns="http://www.w3.org/2000/svg"><defs><style>.cls-1{fill:#80B824;}</style></defs><title/>
                <path class="cls-1" d="M83,23a22,22,0,0,1,22,22V83a22,22,0,0,1-22,22H45A22,22,0,0,1,23,83V45A22,22,0,0,1,45,23H83m0-8H45A30.09,30.09,0,0,0,15,45V83a30.09,30.09,0,0,0,30,30H83a30.09,30.09,0,0,0,30-30V45A30.09,30.09,0,0,0,83,15Z"/>
                <path class="cls-1" d="M90.14,32a5.73,5.73,0,1,0,5.73,5.73A5.73,5.73,0,0,0,90.14,32Z"/>
                <path class="cls-1" d="M64.27,46.47A17.68,17.68,0,1,1,46.6,64.14,17.7,17.7,0,0,1,64.27,46.47m0-8A25.68,25.68,0,1,0,90,64.14,25.68,25.68,0,0,0,64.27,38.47Z"/>
            </svg>
        </a>
      </div>
    </div>
  </div>
</footer>
</body>
</html> 